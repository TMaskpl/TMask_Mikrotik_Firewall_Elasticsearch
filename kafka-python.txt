from kafka import KafkaConsumer
import ssl

# Dane konfiguracyjne
KAFKA_BROKER = 'kafka.example.com:9093'
TOPIC_NAME = 'test-topic'

# Ścieżki do plików certyfikatów
SSL_CAFILE = '/path/to/ca.cer'
SSL_CERTFILE = '/path/to/client.cer'
SSL_KEYFILE = '/path/to/client.key'

# Tworzenie konsumenta Kafka z SSL
consumer = KafkaConsumer(
    TOPIC_NAME,
    bootstrap_servers=KAFKA_BROKER,
    security_protocol='SSL',
    ssl_cafile=SSL_CAFILE,
    ssl_certfile=SSL_CERTFILE,
    ssl_keyfile=SSL_KEYFILE,
    group_id='test-consumer-group',
    auto_offset_reset='earliest',  # zaczynamy od początku
    enable_auto_commit=True
)

print("Połączono z brokerem, oczekiwanie na wiadomości...")

try:
    for message in consumer:
        print(f"Odebrano wiadomość: {message.value.decode('utf-8')}")
except KeyboardInterrupt:
    print("Zakończono działanie konsumenta.")
finally:
    consumer.close()
